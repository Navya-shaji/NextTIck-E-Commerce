<%- include ("../../views/partials/user/header.ejs") %>

  <head>
    <link rel="stylesheet" href="/styles/home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet">
  </head>

  <!-- Hero Section -->
  <section id="home-section" class="hero-section">
    <div class="container">
      <div class="hero-content">
        <div class="hero-text" style="text-align: center; max-width: 800px; margin: 0 auto;">
          <h1 class="hero-title">
            <span class="title-line">MODERN TIMEPIECES</span>
            <span class="title-line accent">FOR THE CURATED LIFE</span>
          </h1>
          <div class="hero-buttons" style="justify-content: center;">
            <a href="#collections" class="btn-primary">SHOP THE COLLECTION</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Collections Section -->
  <section id="collections" class="collections-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">EXCLUSIVE COLLECTIONS</h2>
        <div class="collection-nav">
          <button class="collection-btn active" data-collection="all">ALL</button>
          <button class="collection-btn" data-collection="minimal">MINIMAL</button>
          <button class="collection-btn" data-collection="popular">POPULAR</button>
        </div>
      </div>
      <div class="collections-grid">
        <% if (products && products.length> 0) { %>
          <% products.slice(0, 6).forEach((product, index)=> { %>
            <div class="collection-item" data-collection="<%= index % 2 === 0 ? 'minimal' : 'popular' %>">
              <a href="/productDetails?id=<%= product._id %>" style="text-decoration: none; color: inherit;">
                <div class="watch-container">
                  <img src="/uploads/re-image/<%= product.productImage[0] %>" alt="<%= product.productName %>"
                    class="collection-watch-img">
                  <div class="watch-overlay"></div>
                </div>
                <div class="watch-info">
                  <h3 class="watch-name">
                    <%= product.productName %>
                  </h3>
                  <div class="watch-price">
                    <% let finalPrice=product.regularPrice; let maxOffer=Math.max(product.discount || 0,
                      (product.category && product.category.offer) || 0, product.productOffer || 0); if (maxOffer> 0) {
                      finalPrice = product.regularPrice - (product.regularPrice * maxOffer / 100);
                      %>
                      <span class="sale-price">₹<%= finalPrice.toLocaleString() %></span>
                      <span class="original-price" style="font-size: 0.8em; opacity: 0.5;">₹<%=
                          product.regularPrice.toLocaleString() %></span>
                      <% } else { %>
                        <span class="current-price">₹<%= product.salesPrice.toLocaleString() %></span>
                        <% } %>
                  </div>
                </div>
              </a>
            </div>
            <% }); %>
              <% } else { %>
                <div class="no-products">
                  <h3>Coming Soon</h3>
                  <p>Our exclusive timepiece collection is being curated.</p>
                </div>
                <% } %>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="features-section">
    <div class="container">
      <div class="features-grid">
        <div class="feature-item">
          <h3 class="feature-title">EXPRESS DELIVERY</h3>
          <p class="feature-description">Complimentary worldwide shipping on premium orders.</p>
        </div>
        <div class="feature-item">
          <h3 class="feature-title">AUTHENTICITY GUARANTEED</h3>
          <p class="feature-description">Every timepiece is certified for 100% original craftsmanship.</p>
        </div>
        <div class="feature-item">
          <h3 class="feature-title">CURATED SELECTION</h3>
          <p class="feature-description">Only the finest designs make it into our exclusive boutique.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Newsletter Section -->
  <section class="newsletter-section">
    <div class="container">
      <div class="newsletter-content">
        <h2 class="newsletter-title">JOIN THE ELITE</h2>
        <p class="newsletter-subtitle">Subscribe to receive early access to our limited-release drops.</p>
        <form class="newsletter-form">
          <div class="input-group">
            <input type="email" placeholder="Email address" required>
            <button type="submit" class="subscribe-btn">JOIN</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    // Collection Filter
    document.addEventListener('DOMContentLoaded', () => {
      const btns = document.querySelectorAll('.collection-btn');
      const items = document.querySelectorAll('.collection-item');

      btns.forEach(btn => {
        btn.addEventListener('click', () => {
          btns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          const filter = btn.dataset.collection;

          items.forEach(item => {
            if (filter === 'all' || item.dataset.collection === filter) {
              item.style.display = 'block';
            } else {
              item.style.display = 'none';
            }
          });
        });
      });
    });

    // Smooth Scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });

    // Cart Handler
    function addToCartHandler(event, productId) {
      event.preventDefault();
      fetch('/addToCart', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ productId, quantity: 1 })
      })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            Swal.fire({ title: 'Added', icon: 'success', timer: 1000, showConfirmButton: false });
            if (data.cartCount) document.querySelectorAll('.cart-count').forEach(el => el.textContent = data.cartCount);
          } else {
            Swal.fire({ title: 'Error', text: data.message, icon: 'error' });
          }
        })
        .catch(() => Swal.fire({ title: 'Please Login', icon: 'info' }));
    }

    // Wishlist Handler
    function addToWishlist(productId) {
      fetch('/addToWishlist', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ productId })
      })
        .then(res => res.json())
        .then(data => {
          Swal.fire({ title: data.status ? 'Added to Wishlist' : 'Already in Wishlist', icon: 'info', timer: 1500 });
        });
    }
  </script>

  <%- include ("../../views/partials/user/footer.ejs") %>