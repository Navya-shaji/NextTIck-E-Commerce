<%- include("../../views/partials/user/header.ejs") %>

    <head>
        <link rel="stylesheet" href="/styles/profile.css">
    </head>

    <main class="main">
        <div class="breadcrumb-wrap">
            <div class="profile-container">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/">Home</a></li>
                        <li class="breadcrumb-item"><a href="/userProfile">My Account</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Change Email</li>
                    </ol>
                </nav>
            </div>
        </div>

        <div class="profile-container">
            <div class="premium-form-card">
                <h4 class="card-title">Update Email</h4>
                <p class="text-muted mb-4">Verification is required to change your primary email address.</p>

                <form method="POST" action="/change-email" id="changeEmailForm">
                    <div class="form-group">
                        <label for="email" class="info-label">Current Email Address</label>
                        <input class="form-control" name="email" id="email" placeholder="Enter current email"
                            type="email" required>
                        <small id="emailError" class="text-danger"></small>
                    </div>

                    <div class="mt-4">
                        <button type="submit" class="btn-gold">Verify Current Email</button>
                    </div>

                    <% if (locals.message && message.length> 0) { %>
                        <div class="alert alert-danger mt-4 text-center">
                            <%= message %>
                        </div>
                        <% } %>
                </form>

                <div class="mt-5 pt-3 border-top">
                    <a href="/userProfile" class="link-gold">Back to Profile</a>
                </div>
            </div>
        </div>
    </main>

    <%- include("../../views/partials/user/footer.ejs") %>

        <script>
            document.getElementById('changeEmailForm').addEventListener('submit', function (e) {
                const email = document.getElementById('email').value.trim();
                const emailError = document.getElementById('emailError');
                emailError.textContent = '';

                if (!email) {
                    emailError.textContent = 'Email is required.';
                    e.preventDefault();
                } else if (!/^\S+@\S+\.\S+$/.test(email)) {
                    emailError.textContent = 'Please enter a valid email address.';
                    e.preventDefault();
                }
            });
        </script>