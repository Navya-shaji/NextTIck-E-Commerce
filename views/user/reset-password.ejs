<%- include("../../views/partials/user/header.ejs") %>

<head>
    <link rel="stylesheet" href="/styles/profile.css">
</head>

<main class="main">
    <div class="breadcrumb-wrap">
        <div class="profile-container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Reset Password</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="profile-container">
        <div class="premium-form-card">
            <h4 class="card-title">New Password</h4>
            <p class="text-muted mb-4">Set a strong password to protect your account.</p>
            
            <form method="POST" action="/reset-password" id="resetPassForm">
                <div class="form-group">
                    <label for="newPass1" class="info-label">New Password</label>
                    <input class="form-control" name="newPass1" id="newPass1" placeholder="Minimum 6 characters" type="password" required>
                    <small id="newPass1Error" class="text-danger"></small>
                </div>

                <div class="form-group">
                    <label for="newPass2" class="info-label">Confirm New Password</label>
                    <input class="form-control" name="newPass2" id="newPass2" placeholder="Re-enter password" type="password" required>
                    <small id="newPass2Error" class="text-danger"></small>
                </div>
                
                <div class="mt-4">
                    <button type="submit" class="btn-gold">Update Password</button>
                </div>

                <% if (locals.message && message.length > 0) { %>
                    <div class="alert alert-danger mt-4 text-center">
                        <%= message %>
                    </div>
                <% } %>
            </form>
        </div>
    </div>
</main>

<%- include("../../views/partials/user/footer.ejs") %>

<script>
document.getElementById('resetPassForm').addEventListener('submit', function(e) {
    let valid = true;
    const p1 = document.getElementById('newPass1');
    const p2 = document.getElementById('newPass2');
    const e1 = document.getElementById('newPass1Error');
    const e2 = document.getElementById('newPass2Error');

    e1.textContent = '';
    e2.textContent = '';

    if (p1.value.length < 6) {
        e1.textContent = 'Password must be at least 6 characters.';
        valid = false;
    }
    if (p1.value !== p2.value) {
        e2.textContent = 'Passwords do not match.';
        valid = false;
    }

    if (!valid) e.preventDefault();
});
</script>
